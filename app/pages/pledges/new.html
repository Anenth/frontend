<div ng-controller="FundraisersController">
  <ul class="breadcrumb">
    <li><a href="/">Home</a><span class="divider">»</span></li>
    <li><a href="/fundraisers">Fundraisers</a><span class="divider">»</span></li>
    <li><a href="/fundraisers/{{ fundraiser.id }}">{{ fundraiser.title || 'Loading...' }}</a><span class="divider">»</span></li>
    <li><a>Make Pledge</a></li>
  </ul>

  <div class="row-fluid" ng-show="fundraiser">
    <div class="span9">
      <div ng-include="'pages/fundraisers/partials/header.html'"></div>

      <ul class="nav nav-tabs">
        <li><a ng-href="/fundraisers/{{fundraiser.slug}}">Overview</a></li>
        <li ng-show="fundraiser.published"><a ng-href="/fundraisers/{{fundraiser.slug}}/updates">
          Updates
          <span ng-show="fundraiser.updates.length > 0" class="badge badge-warning">{{fundraiser.updates.length | number:0}}</span>
        </a></li>
        <li ng-show="fundraiser.published"><a ng-href="/fundraisers/{{fundraiser.slug}}/pledges">
          Pledges
          <span ng-show="fundraiser.pledge_count > 0" class="badge badge-warning">{{fundraiser.pledge_count | number:0}}</span>
        </a></li>
        <li class="active"><a ng-href="/fundraisers/{{ fundraiser.slug }}/pledge">Make a Pledge</a></li>
      </ul>

      <form class="form-horizontal" name="pledge_form">
        <div class="control-group" ng-show="payment_error">
          <alert type="error" close="payment_error = null">{{ payment_error }}</alert>
        </div>

        <div class="control-group">
          <label class="control-label" for="amount">Pledge Amount</label>

          <div class="controls">
            <div class="input-prepend">
              <span class="add-on">$</span>
              <input type="number" min="5" id="amount" ng-model="pledge.amount" placeholder="Pledge amount" autofocus />
            </div>
          </div>
        </div>

        <div class="control-group">
          <label class="control-label">Payment Method</label>

          <div class="controls">
            <label class="radio">
              <input type="radio" ng-model="pledge.payment_method" value="google" selected/>
              <img src="images/google-wallet.png">
              Google Wallet
            </label>

            <label class="radio">
              <input type="radio" ng-model="pledge.payment_method" value="paypal" />
              <img src="images/paypal.png">
              PayPal
            </label>

            <!--<label class="radio">-->
            <!--<input type="radio" ng-model="pledge.payment_method" value="gittip" />-->
            <!--<img src="images/gittip.png">-->
            <!--Gittip-->
            <!--</label>-->

            <label class="radio" ng-show="current_person && current_person.account.balance > 0">
              <input type="radio" ng-model="pledge.payment_method" value="personal" />
              <img src="favicon.ico">
              Bountysource {{ current_person.account.balance | currency }}
            </label>

            <label class="checkbox">
              Make anonymous
              <input type="checkbox" id="anonymous" ng-model="pledge.anonymous" />
            </label>
          </div>
        </div>

        <div class="control-group">
          <label class="control-label">Select a Reward</label>

          <div class="controls">

            <div class="row-fluid">
              <div class="span4">
                <label class="radio" popover="No reward please, I just want to help out." popover-placement="right" popover-trigger="mouseenter">
                  <input type="radio" ng-model="pledge.reward_id" value="0" ng-change="set_reward(0)" />
                  <div>No Reward</div>
                </label>

                <label class="radio" ng-repeat="reward in fundraiser.rewards" popover="{{reward.description}}" popover-placement="right" popover-trigger="mouseenter">
                  <input type="radio" ng-model="pledge.reward_id" value="{{reward.id}}" ng-change="set_reward(reward)" />
                  <div>${{ reward.amount | number:0 }} Reward tier</div>
                </label>
              </div>
            </div>
          </div>
        </div>

        <div class="control-group">
          <div class="controls">
            <button ng-click="create_payment()" class="btn btn-success btn-large" ng-disabled="!pledge.amount || !pledge.payment_method">Make ${{ (pledge.amount || 0) | number:0 }} Pledge</button>
          </div>
        </div>
      </form>
    </div>

    <div class="span3">
      <div ng-include="'pages/fundraisers/partials/manage.html'"></div>
      <div ng-include="'pages/fundraisers/partials/about_me.html'"></div>
      <div ng-include="'pages/fundraisers/partials/progress_small.html'"></div>
    </div>
  </div>
</div>
